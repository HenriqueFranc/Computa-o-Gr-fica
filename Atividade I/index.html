<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráficos Covid</title>
    <script  src="app.js" defer></script>
    <script  src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css">
    
</head>
<body>
    <h3>Casos Acumulados Covid-19 para 2020 para cada região do Brasil</h3>
    <script>
        function calcularPosicaoBarra(valor) {
    return 680 - (valor / 40);
}

function calcularAlturaBarra(valor) {
    return (valor / 40);
}

function calcularPosicaoYTexto(valor) {
    return 680 - (valor / 40) - 5;
}

function read () {
    return fetch('df.csv')
    .then(response => {
        return response.text()
    })
}
            $(document).ready(function() {
            $.ajax({
                type: "GET",
                url: "df.csv",
                dataType: "text",
                success: function(data) {processData(data);}
            });
        });

        function processData(allText) {
            var allTextLines = allText.split(/\r\n|\n/);
            var headers = allTextLines[0].split(',');
            var lines = [];

            for (var i=1; i<allTextLines.length; i++) {
                var data = allTextLines[i].split(',');
                if (data.length == headers.length) {

                    var tarr = {};
                    for (var j=0; j<headers.length; j++) {
                        let  key = headers[j]
                        let  value = data[j]
                        tarr[key]= value
                        
                    }
                    lines.push(tarr);
                }
            }
            console.log(lines)
            var centro_Value = lines[0].casosAcumulados
            var posicaoBarraCentro = calcularPosicaoBarra(centro_Value)
            var alturaBarraCentro = calcularAlturaBarra(centro_Value)
            var posicaoTextCentro = calcularPosicaoYTexto(centro_Value)

            var nordeste_Value = lines[1].casosAcumulados
            var norte_Value = lines[2].casosAcumulados
            var sudeste_Value = lines[3].casosAcumulados
            var sul_Value = lines[4].casosAcumulados
        }

    </script>
    <svg id="svg" width=1280 height=720 class="bar-chart">
        <!-- Eixo X -->
        <line x1="100" y1="700" x2="100" y2="0" style="stroke:#000000; stroke-width: 1px;" />
        <!-- Eixo Y -->
        <line x1="70" y1="680" x2="1270" y2="680" style="stroke:#000000; stroke-width: 1px;" />

        <g class="eixo-y">
            <g>
                <line x1="90" y1="630" x2="110" y2="630" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="635">2000</text>
            </g>
            <g>
                <line x1="90" y1="580" x2="110" y2="580" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="585">2000</text>
            </g>
            <g>
                <line x1="90" y1="530" x2="110" y2="530" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="535">2000</text>
            </g>
            <g>
                <line x1="90" y1="480" x2="110" y2="480" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="485">2000</text>
            </g>
            <g>
                <line x1="90" y1="430" x2="110" y2="430" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="435">2000</text>
            </g>
            <g>
                <line x1="90" y1="380" x2="110" y2="380" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="385">2000</text>
            </g>
            <g>
                <line x1="90" y1="330" x2="110" y2="330" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="335">2000</text>
            </g>
            <g>
                <line x1="90" y1="280" x2="110" y2="280" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="285">2000</text>
            </g>
            <g>
                <line x1="90" y1="230" x2="110" y2="230" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="235">2000</text>
            </g>
            <g>
                <line x1="90" y1="180" x2="110" y2="180" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="185">2000</text>
            </g>
            <g>
                <line x1="90" y1="130" x2="110" y2="130" style="stroke:#000000; stroke-width: 1px;" />
    
                <text  x="50" y="135">2000</text>
            </g>
        </g>

        <!-- Cálculo da posição
            valor de y: 680 - valor do banco / 40
            height: valor do banco / 40
            posição y do texto: height  - 5
            40 é o valor de pixels por número de casos
        -->
        <g class="centro-oeste">
            <rect class="rectCT" x="200" y='0' height="25.32" width="150"
            style="fill: #000000"/>
            <text  x="275" y="650" style="text-anchor: middle">1013</text>
            <text  x="275" y="700" style="text-anchor: middle">Centro Oeste</text>
        </g>
        <g class="nordeste">
            <rect class="rect" x="400" y="544.475" height="135.525" width="150"
            style="fill: #000000"/>
            <text  x="475" y="540" style="text-anchor: middle">5421</text>
            <text  x="475" y="700" style="text-anchor: middle">Nordeste</text>
        </g>
        <g class="norte">
            <rect class="rect" x="600" y="589.125" height="90.875" width="150"
            style="fill: #000000"/>
            <text  x="675" y="584" style="text-anchor: middle">3635</text>
            <text  x="675" y="700" style="text-anchor: middle">Norte</text>
        </g>
        <g class="sudeste">
            <rect class="rect" x="800" y="180" height="500.1" width="150"
            style="fill: #000000"/>
            <text  x="875" y="175" style="text-anchor: middle">20004</text>
            <text  x="875" y="700" style="text-anchor: middle">Sudeste</text>
        </g>
        <g class="sul">
            <rect class="rect" x="1000" y="649.775" height="30.225" width="150"
            style="fill: #000000"/>
            <text  x="1075" y="645" style="text-anchor: middle">1209</text>
            <text  x="1075" y="700" style="text-anchor: middle">Sul</text>
        </g>
    </svg>
</body>
</html>